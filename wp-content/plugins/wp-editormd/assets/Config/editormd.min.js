!function(c,p,e,u){var t,i;function r(e,t){var i;switch(t){case"emojify":i=e+"/assets/Emojify.js/images/basic";break;case"katex":i=e+"/assets/KaTeX";break;case"mermaid":i=e+"/assets/Mermaid";break;case"prismjs":i=e+"/assets/Prism.js";break;case"codemirror":i=e+"/assets/CodeMirror";break;case"marked":i=e+"/assets/Marked"}return i}c(p).ready(function(){var i=null;if(p.getElementById("wp-content-editor-container"))i="wp-content-editor-container";else if(p.getElementById("wp-replycontent-editor-container")&&"on"===u.supportReply)i="wp-replycontent-editor-container";else if(p.getElementById("comment")&&"on"===u.supportComment)i="comment",c("#comment").after("<div id='comment'></div>").remove();else{if(""===u.supportOther)return!1;i=u.supportOther,c("#"+u.supportOther).after("<div id="+u.supportOther+"></div>").remove()}var e,t=["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","code-block","table","datetime","off"!==u.emoji?"emoji":"html-entities","more","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],r=["bold","del","italic","quote","ucwords","uppercase","lowercase","|","link","reference-link","image","code","code-block","table","datetime","off"!==u.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","clear","info"],o=["ucwords","uppercase","lowercase","|","link","reference-link","image","table","datetime","off"!==u.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","info"];switch(i){case"wp-content-editor-container":e=t;break;case"comment":e=r;break;case"wp-replycontent-editor-container":e=o;break;default:e=t}var l=editormd({id:i,path:u.editormdUrl+"/assets/Editormd/lib/",width:"100%",height:"wp-content-editor-container"===i?640:320,syncScrolling:"off"!==u.syncScrolling,watch:"wp-replycontent-editor-container"!==i&&"off"!==u.livePreview,htmlDecode:"off"!==u.htmlDecode,toolbarAutoFixed:!1,toolbar:!0,autoFocus:"comment"!==i,tocm:!1,tocContainer:"off"!==u.toc&&"",tocDropdown:!1,theme:u.theme,previewTheme:u.previewTheme,editorTheme:u.editorTheme,emoji:"off"!==u.emoji,tex:"katex"===u.tex,mind:"off"!==u.mindMap,mermaid:"off"!==u.mermaid,atLink:!1,taskList:"off"!==u.taskList,imageUpload:"off"!==u.imagePasteSM,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"https://sm.ms/api/upload",placeholder:u.placeholderEditor,prismTheme:u.prismTheme,prismLineNumbers:"off"!==u.prismLineNumbers,toolbarIcons:function(){return e},onfullscreen:function(){p.getElementById(i).style.position="fixed",p.getElementById(i).style.zIndex="99999"},onfullscreenExit:function(){p.getElementById(i).style.position="relative",p.getElementById(i).style.zIndex="auto"},onload:function(){if("comment"===i&&c("textarea.editormd-markdown-textarea").attr("name","comment"),"wp-replycontent-editor-container"===i&&c(".reply").click(function(){setTimeout(function(){c(".edit-comments-php .CodeMirror.cm-s-default.CodeMirror-wrap").css("margin-top",c(".editormd-toolbar").height())},100)}),1600===function(){if(this.innerWidth)return this.innerWidth;if(document.documentElement&&document.documentElement.clientWidth)return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth}()){var e=c(".editormd .CodeMirror.CodeMirror-wrap"),t=e.css("margin-top");e.css("margin-top",parseInt(t)-32+"px")}}});if("undefined"!=typeof wp&&void 0!==wp.media){var a=wp.media.editor.insert,n=new TurndownService;wp.media.editor.insert=function(e){var t=n.turndown(e);a(t),l.insertValue(t)}}"on"===u.imagePaste&&c("#"+i).on("paste",function(e){e=e.originalEvent;var t=window.clipboardData||e.clipboardData,i=window.navigator.userAgent;if(e.clipboardData&&e.clipboardData.items){var n={line:l.getCursor().line,ch:l.getCursor().ch};if(!(t.items&&2===t.items.length&&"string"===t.items[0].kind&&"file"===t.items[1].kind&&t.types&&2===t.types.length&&"text/plain"===t.types[0]&&"Files"===t.types[1]&&i.match(/Macintosh/i)&&Number(i.match(/Chrome\/(\d{2})/i)[1])<49)){var r,o,a,d=t.items.length;if(0!==d)if(1!==d||"string"!==t.items[0].kind)if(1===d&&"file"===t.items[0].kind||2===d&&"file"===t.items[1].kind){if(1===d)var s=t.items[0];else s=t.items[1];var m=s.getAsFile();if(0===m.size)return;r=m,o=function(e){var i="!["+u.imgUploading+"]",r="!["+u.imgUploadeFailed+"]",t={action:"imagepaste_action",dataurl:e};if(l.insertValue(i),"on"===u.imagePasteSM){var o=new FormData,a="http:"!==p.location.protocol;o.append("smfile",function(e){var t;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURI(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([r],{type:i})}(e)),o.append("ssl",a),o.append("format","json"),c.ajax({url:"https://sm.ms/api/upload",type:"POST",processData:!1,dataType:"json",contentType:!1,data:o,success:function(e){"success"===e.code?"on"===u.imageLink?l.setValue(l.getValue().replace(i,"[!["+e.data.filename+"]("+e.data.url+")]("+e.data.url+")")):l.setValue(l.getValue().replace(i,"!["+e.data.filename+"]("+e.data.url+")")):l.setValue(l.getValue().replace(i,r+"[ "+e.msg+" ]")),l.setCursor(n),l.focus()}})}else c.ajax({url:ajaxurl,type:"POST",data:t,success:function(e){var t=JSON.parse(e);t.error?l.setValue(l.getValue().replace(i,r)):"on"===u.imageLink?l.setValue(l.getValue().replace(i,"[![]("+t.url+")]("+t.url+")")):l.setValue(l.getValue().replace(i,"![]("+t.url+")")),l.setCursor(n),l.focus()}})},(a=new FileReader).onload=function(e){o(e.target.result)},a.readAsDataURL(r)}}}})}),editormd.codeMirrorURL={url:r(u.editormdUrl,"codemirror")},editormd.markedURL={js:r(u.editormdUrl,"marked")+"/marked.min"},editormd.prismURL={url:r(u.editormdUrl,"prismjs")},editormd.mindMapURL=(t=u.mindMapURL,null!==(i=/\.{1}[a-z]{1,}$/).exec(t)?t.slice(0,i.exec(t).index):t),"on"===u.tex&&(editormd.katexURL={css:r(u.editormdUrl,"katex")+"/katex.min",js:r(u.editormdUrl,"katex")+"/katex.min"}),"on"===u.mermaid&&(editormd.mermaidURL={js:r(u.editormdUrl,"mermaid")+"/mermaid.min"}),"on"===u.emoji&&(editormd.emoji={path:r(u.editormdUrl,"emojify")+"/",ext:".png"})}(window.jQuery,document,window,window.Editormd);